此为简化后的开源代码
